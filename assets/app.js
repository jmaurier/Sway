angular.module("app",["ngRoute"]),angular.module("app",["ngRoute","toastr","angularModalService"]).controller("ApplicationCtrl",["$scope","$location","$window","UserSvc","toastr","ModalService",function(e,t,n,o,a,r){if(e.$on("login",function(n,o){e.currentUser=o,t.path("/")}),e.logout=function(){delete e.currentUser,t.path("/login"),window.sessionStorage.removeItem("token")},o.isLoggedIn()){o.getUser().then(function(t){e.currentUser=t})}else t.path("/login")}]),angular.module("app").controller("DashboardCtrl",["$scope","$location","UserSvc","TimesheetSvc","toastr","ModalService",function(e,t,n,o,a,r){n.isLoggedIn()||t.path("/login"),e.createNewTimeSheet=function(n,a){var r=new Date(a.getFullYear(),a.getMonth(),a.getDate()+1);r===a&&console.log(r),o.create({title:n,week_beginning:a,week_one:{sunday:{date:Date(a.getFullYear(),a.getMonth(),a.getDate()+5)},monday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+1)},tuesday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+2)},wednesday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+3)},thursday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+4)},friday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+5)},saturday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+6)}},week_two:{sunday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+7)},monday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+8)},tuesday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+9)},wednesday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+10)},thursday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+11)},friday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+12)},saturday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+13)}}}).success(function(n){e.timesheets.unshift(n),t.path("/")})},o.fetch().success(function(t){console.log(t),e.timesheets=t})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc","toastr",function(e,t,n){e.login=function(n,o){e.errorMsg="",t.login(n,o).then(function(t){e.$emit("login",t)},function(t){e.errorMsg="Incorrect H Number/Password."})}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc","toastr",function(e,t,n){e.error=!1,e.errormsg="",e.register=function(o,a,r,s){t.register(o,a,r,s).then(function(t){e.$emit("login",t)},function(t){console.log(t),401==t.status&&(e.error=!0,n.error("This H-Number is already in use, faggot.","Error"))})}}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"DashboardCtrl",templateUrl:"/templates/dashboard.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"/templates/register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"/templates/login.html"}).when("/timesheet/:timesheet_id",{controller:"TimesheetCtrl",templateUrl:"/templates/timesheet.html"})}]),angular.module("app").controller("TimesheetCtrl",["$scope","$routeParams","$location","UserSvc","TimesheetSvc","toastr",function(e,t,n,o,a,r){o.isLoggedIn()||n.path("/login"),a.fetchById(t.timesheet_id).then(function(t){e.timesheet=t.data})}]),angular.module("app").service("TimesheetSvc",["$http",function(e){this.fetch=function(){return e.get("/api/timesheets")},this.fetchById=function(t){return e.get("/api/timesheets/"+t)},this.create=function(t){return e.post("/api/timesheets",t)}}]),angular.module("app").service("UserSvc",["$http",function(e){var t=this;t.getUser=function(){return e.get("/api/users").then(function(e){return e.data})},t.login=function(n,o){return e.post("/api/sessions",{H_number:n,password:o}).then(function(n){return window.sessionStorage.token=n.data,e.defaults.headers.common["x-auth"]=n.data,t.getUser()})},t.register=function(n,o,a,r){return e.post("/api/users",{H_number:n,password:o,name:a,emailaddr:r}).then(function(){return t.login(n,o)},function(e){console.log(e)})},t.isLoggedIn=function(){var t=!1;return window.sessionStorage.token&&(e.defaults.headers.common["x-auth"]=window.sessionStorage.token,t=!0),t}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJkYXNoYm9hcmQuY3RybC5qcyIsImxvZ2luLmN0cmwuanMiLCJyZWdpc3Rlci5jdHJsLmpzIiwicm91dGVzLmpzIiwidGltZXNoZWV0LmN0cmwuanMiLCJ0aW1lc2hlZXQuc3ZjLmpzIiwidXNlci5zdmMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkbG9jYXRpb24iLCIkd2luZG93IiwiVXNlclN2YyIsInRvYXN0ciIsIk1vZGFsU2VydmljZSIsIiRvbiIsIl8iLCJ1c2VyIiwiY3VycmVudFVzZXIiLCJwYXRoIiwibG9nb3V0Iiwid2luZG93Iiwic2Vzc2lvblN0b3JhZ2UiLCJyZW1vdmVJdGVtIiwiaXNMb2dnZWRJbiIsImdldFVzZXIiLCJ0aGVuIiwicmVzcG9uc2UiLCJUaW1lc2hlZXRTdmMiLCJjcmVhdGVOZXdUaW1lU2hlZXQiLCJ0aXRsZSIsIndlZWtfYmVnaW5uaW5nIiwidGVtcERhdGUiLCJEYXRlIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERhdGUiLCJjb25zb2xlIiwibG9nIiwiY3JlYXRlIiwid2Vla19vbmUiLCJzdW5kYXkiLCJkYXRlIiwibW9uZGF5IiwidHVlc2RheSIsIndlZG5lc2RheSIsInRodXJzZGF5IiwiZnJpZGF5Iiwic2F0dXJkYXkiLCJ3ZWVrX3R3byIsInN1Y2Nlc3MiLCJ0aW1lX3NoZWV0IiwidGltZXNoZWV0cyIsInVuc2hpZnQiLCJmZXRjaCIsImxvZ2luIiwiSF9udW1iZXIiLCJwYXNzd29yZCIsImVycm9yTXNnIiwiJGVtaXQiLCJlcnJvciIsImVycm9ybXNnIiwicmVnaXN0ZXIiLCJuYW1lIiwiZW1haWxhZGRyIiwic3RhdHVzIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCIkcm91dGVQYXJhbXMiLCJmZXRjaEJ5SWQiLCJ0aW1lc2hlZXRfaWQiLCJ0aW1lc2hlZXQiLCJkYXRhIiwic2VydmljZSIsIiRodHRwIiwidGhpcyIsImdldCIsImlkIiwicG9zdCIsInN2YyIsInRva2VuIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiY29tbW9uIiwicmVzdWx0Il0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBQUMsT0FBQSxPQUNFLFlDREZELFFBQUFDLE9BQUEsT0FBQSxVQUFBLFNBQUEsd0JBQ0FDLFdBQUEsbUJBQStCLFNBQUEsWUFBQSxVQUFBLFVBQUEsU0FBQSxlQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBWTdCLEdBWEFMLEVBQUFNLElBQUEsUUFBQSxTQUFBQyxFQUFBQyxHQUNFUixFQUFBUyxZQUFBRCxFQUNBUCxFQUFBUyxLQUFBLE9BR0ZWLEVBQUFXLE9BQUEsaUJBQ0NYLEdBQUEsWUFDQ0MsRUFBQVMsS0FBQSxVQUNBRSxPQUFBQyxlQUFBQyxXQUFBLFVBR0ZYLEVBQUFZLGFBQ0UsQ0FBQVosRUFBQWEsVUFBQUMsS0FBQSxTQUFBQyxHQUNFbEIsRUFBQVMsWUFBQVMsUUFHRmpCLEdBQUFTLEtBQUEsYUNsQkpiLFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxpQkFBNkIsU0FBQSxZQUFBLFVBQUEsZUFBQSxTQUFBLGVBQUEsU0FBQUMsRUFBQUMsRUFBQUUsRUFBQWdCLEVBQUFmLEVBQUFDLEdBRTVCRixFQUFBWSxjQUNDZCxFQUFBUyxLQUFBLFVBR0RWLEVBQUFvQixtQkFBQSxTQUFBQyxFQUFBQyxHQUNDLEdBQUFDLEdBQUEsR0FBQUMsTUFBQUYsRUFBQUcsY0FBQUgsRUFBQUksV0FBQUosRUFBQUssVUFBQSxFQUNBSixLQUFBRCxHQUNHTSxRQUFBQyxJQUFBTixHQUNGSixFQUFBVyxRQUNLVCxNQUFBQSxFQUNBQyxlQUFBQSxFQUNBUyxVQUNDQyxRQUFBQyxLQUFBVCxLQUFBRixFQUFBRyxjQUFBSCxFQUFBSSxXQUFBSixFQUFBSyxVQUFBLElBQ0FPLFFBQUFELEtBQUEsR0FBQVQsTUFBQUYsRUFBQUcsY0FBQUgsRUFBQUks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RCxNQUNBSSxHQUFBLEdBRUZBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4gICduZ1JvdXRlJ1xuXSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ25nUm91dGUnLCd0b2FzdHInLCdhbmd1bGFyTW9kYWxTZXJ2aWNlJ10pXG4uY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCAkd2luZG93LCBVc2VyU3ZjLCB0b2FzdHIsIE1vZGFsU2VydmljZSkge1xuICAkc2NvcGUuJG9uKCdsb2dpbicsIGZ1bmN0aW9uIChfLCB1c2VyKSB7XG4gICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlclxuICAgICRsb2NhdGlvbi5wYXRoKCcvJylcbiAgfSlcblxuICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKXtcbiAgXHRkZWxldGUoJHNjb3BlLmN1cnJlbnRVc2VyKSBcbiAgICAkbG9jYXRpb24ucGF0aCgnL2xvZ2luJylcbiAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgndG9rZW4nKVxuICB9XG5cbiAgaWYoVXNlclN2Yy5pc0xvZ2dlZEluKCkpe1xuXHQgIFx0dmFyIHVzZXIgPSBVc2VyU3ZjLmdldFVzZXIoKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcblx0XHQgICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gcmVzcG9uc2U7XG5cdCAgXHR9KVxuIFx0fWVsc2Uge1xuICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKVxuICB9XG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdEYXNoYm9hcmRDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCBVc2VyU3ZjLCBUaW1lc2hlZXRTdmMsIHRvYXN0ciwgTW9kYWxTZXJ2aWNlKSB7XG5cblx0aWYoIVVzZXJTdmMuaXNMb2dnZWRJbigpKXtcblx0XHQkbG9jYXRpb24ucGF0aCgnL2xvZ2luJylcblx0fVxuXG5cdCRzY29wZS5jcmVhdGVOZXdUaW1lU2hlZXQgPSBmdW5jdGlvbih0aXRsZSwgd2Vla19iZWdpbm5pbmcpe1xuXHRcdHZhciB0ZW1wRGF0ZSA9IG5ldyBEYXRlKHdlZWtfYmVnaW5uaW5nLmdldEZ1bGxZZWFyKCksIHdlZWtfYmVnaW5uaW5nLmdldE1vbnRoKCksIHdlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDEpXG5cdFx0aWYodGVtcERhdGUgPT09IHdlZWtfYmVnaW5uaW5nKVxuXHQgIFx0XHRjb25zb2xlLmxvZyh0ZW1wRGF0ZSk7XG5cdCAgVGltZXNoZWV0U3ZjLmNyZWF0ZSh7XG4gICAgICAgIHRpdGxlOiB0aXRsZSxcbiAgICAgICAgd2Vla19iZWdpbm5pbmc6IHdlZWtfYmVnaW5uaW5nLFxuICAgICAgICB3ZWVrX29uZTp7XG4gICAgICAgIFx0c3VuZGF5OntkYXRlOkRhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNSkgfSxcblx0ICAgICAgICBtb25kYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgMSl9LFxuXHQgICAgICAgIHR1ZXNkYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgMil9LFxuXHQgICAgICAgIHdlZG5lc2RheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAzKX0sXG5cdCAgICAgICAgdGh1cnNkYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNCl9LFxuXHQgICAgICAgIGZyaWRheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyA1KX0sXG4gICAgICAgIFx0c2F0dXJkYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNil9XG4gICAgICAgIH0sXG4gICAgICAgIHdlZWtfdHdvOntcbiAgICAgICAgXHRzdW5kYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNyl9LFxuXHQgICAgICAgIG1vbmRheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyA4KX0sXG5cdCAgICAgICAgdHVlc2RheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyA5KX0sXG5cdCAgICAgICAgd2VkbmVzZGF5OntkYXRlOm5ldyBEYXRlKHdlZWtfYmVnaW5uaW5nLmdldEZ1bGxZZWFyKCksIHdlZWtfYmVnaW5uaW5nLmdldE1vbnRoKCksIHdlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDEwKX0sXG5cdCAgICAgICAgdGh1cnNkYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgMTEpfSxcblx0ICAgICAgICBmcmlkYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgMTIpfSxcbiAgICAgICAgXHRzYXR1cmRheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAxMyl9XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAuc3VjY2VzcyhmdW5jdGlvbiAodGltZV9zaGVldCkge1xuICAgICAgXHQkc2NvcGUudGltZXNoZWV0cy51bnNoaWZ0KHRpbWVfc2hlZXQpXG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgICB9KVxuXHR9XG5cblx0VGltZXNoZWV0U3ZjLmZldGNoKCkuc3VjY2VzcyhmdW5jdGlvbiAodGltZXNoZWV0cykge1xuXHRcdGNvbnNvbGUubG9nKHRpbWVzaGVldHMpO1xuXHRcdCRzY29wZS50aW1lc2hlZXRzID0gdGltZXNoZWV0cztcblx0fSlcblx0XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignTG9naW5DdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgVXNlclN2YywgdG9hc3RyKSB7XG4gICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uIChIX251bWJlciwgcGFzc3dvcmQpIHtcbiAgXHQkc2NvcGUuZXJyb3JNc2cgPSAnJztcbiAgICBVc2VyU3ZjLmxvZ2luKEhfbnVtYmVyLCBwYXNzd29yZClcbiAgICAudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgICAgJHNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpXG4gICAgfSwgZnVuY3Rpb24oZXJyb3Ipe1xuICAgIFx0JHNjb3BlLmVycm9yTXNnID0gXCJJbmNvcnJlY3QgSCBOdW1iZXIvUGFzc3dvcmQuXCI7XG4gICAgfSlcbiAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMsIHRvYXN0cikge1xuXG5cdCRzY29wZS5lcnJvcj1mYWxzZTtcblx0JHNjb3BlLmVycm9ybXNnPVwiXCI7XG5cblx0JHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKEhfbnVtYmVyLCBwYXNzd29yZCwgbmFtZSwgZW1haWxhZGRyKSB7XG5cdFx0VXNlclN2Yy5yZWdpc3RlcihIX251bWJlciwgcGFzc3dvcmQsIG5hbWUsIGVtYWlsYWRkcilcblx0XHRcdC50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG5cdFx0XHQgICRzY29wZS4kZW1pdCgnbG9naW4nLCB1c2VyKVxuXHRcdFx0fSwgZnVuY3Rpb24oZXJyb3Ipe1xuXHRcdFx0XHRjb25zb2xlLmxvZyhlcnJvcik7XG5cdFx0XHQgIGlmIChlcnJvci5zdGF0dXMgPT0gNDAxKXtcblx0XHRcdCAgXHQkc2NvcGUuZXJyb3IgPSB0cnVlO1xuXHRcdFx0XHR0b2FzdHIuZXJyb3IoJ1RoaXMgSC1OdW1iZXIgaXMgYWxyZWFkeSBpbiB1c2UsIGZhZ2dvdC4nLCAnRXJyb3InKTtcblx0XHRcdCAgfVxuXHRcdFx0fSlcblx0fVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpIHtcblx0JHJvdXRlUHJvdmlkZXJcblx0LndoZW4oJy8nLCAgICAgICAgIHsgY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwnLCB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvZGFzaGJvYXJkLmh0bWwnIH0pXG5cdC53aGVuKCcvcmVnaXN0ZXInLCB7IGNvbnRyb2xsZXI6ICdSZWdpc3RlckN0cmwnLCB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvcmVnaXN0ZXIuaHRtbCcgfSlcblx0LndoZW4oJy9sb2dpbicsICAgIHsgY29udHJvbGxlcjogJ0xvZ2luQ3RybCcsIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9sb2dpbi5odG1sJyB9KVxuXHQud2hlbignL3RpbWVzaGVldC86dGltZXNoZWV0X2lkJyx7IGNvbnRyb2xsZXI6ICdUaW1lc2hlZXRDdHJsJywgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL3RpbWVzaGVldC5odG1sJyB9KVxufSlcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignVGltZXNoZWV0Q3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsJHJvdXRlUGFyYW1zLCAkbG9jYXRpb24sIFVzZXJTdmMsIFRpbWVzaGVldFN2YywgdG9hc3RyKSB7XG5cblx0aWYoIVVzZXJTdmMuaXNMb2dnZWRJbigpKXtcblx0XHQkbG9jYXRpb24ucGF0aCgnL2xvZ2luJylcblx0fVxuXG5cdFRpbWVzaGVldFN2Yy5mZXRjaEJ5SWQoJHJvdXRlUGFyYW1zLnRpbWVzaGVldF9pZCkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAkc2NvcGUudGltZXNoZWV0ID0gcmVzcG9uc2UuZGF0YTtcbiAgICB9KVxuXHRcbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdUaW1lc2hlZXRTdmMnLCBmdW5jdGlvbiAoJGh0dHApIHtcbiAgXG4gIHRoaXMuZmV0Y2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS90aW1lc2hlZXRzJylcbiAgfVxuXG4gIHRoaXMuZmV0Y2hCeUlkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS90aW1lc2hlZXRzLycgKyBpZClcbiAgfVxuXG4gIHRoaXMuY3JlYXRlID0gZnVuY3Rpb24odGltZXNoZWV0KXtcbiAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS90aW1lc2hlZXRzJywgdGltZXNoZWV0KTtcbiAgfVxuICBcbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnVXNlclN2YycsIGZ1bmN0aW9uICgkaHR0cCkge1xuICB2YXIgc3ZjID0gdGhpc1xuICBzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJylcbiAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhXG4gICAgfSlcbiAgfVxuICBzdmMubG9naW4gPSBmdW5jdGlvbiAoSF9udW1iZXIsIHBhc3N3b3JkKSB7XG4gICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMnLCB7XG4gICAgICBIX251bWJlcjogSF9udW1iZXIsIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW4gPSByZXNwb25zZS5kYXRhXG4gICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsneC1hdXRoJ10gPSByZXNwb25zZS5kYXRhXG4gICAgICByZXR1cm4gc3ZjLmdldFVzZXIoKVxuICAgIH0pXG4gIH1cbiAgc3ZjLnJlZ2lzdGVyID0gZnVuY3Rpb24gKEhfbnVtYmVyLCBwYXNzd29yZCwgbmFtZSwgZW1haWxhZGRyKSB7XG4gICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XG4gICAgICBIX251bWJlcjogSF9udW1iZXIsIHBhc3N3b3JkOiBwYXNzd29yZCwgbmFtZTogbmFtZSwgZW1haWxhZGRyOiBlbWFpbGFkZHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzdmMubG9naW4oSF9udW1iZXIsIHBhc3N3b3JkKVxuICAgIH0sIGZ1bmN0aW9uKGVycm9yKXtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICB9KVxuICB9XG4gIHN2Yy5pc0xvZ2dlZEluID0gZnVuY3Rpb24gKCl7XG4gICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xuICAgIGlmKHdpbmRvdy5zZXNzaW9uU3RvcmFnZS50b2tlbil7XG4gICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsneC1hdXRoJ10gPSB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW5cbiAgICAgIHJlc3VsdCA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbn0pXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=