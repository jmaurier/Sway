angular.module("app",["ngRoute"]),angular.module("app",["ngRoute","toastr"]).controller("ApplicationCtrl",["$scope","$location","$window","UserSvc","toastr",function(e,t,n,o,a){if(e.$on("login",function(n,o){e.currentUser=o,t.path("/")}),e.logout=function(){delete e.currentUser,t.path("/login"),window.sessionStorage.removeItem("token")},o.isLoggedIn()){o.getUser().then(function(t){e.currentUser=t})}else t.path("/login")}]),angular.module("app").controller("DashboardCtrl",["$scope","$location","UserSvc","TimesheetSvc","toastr",function(e,t,n,o,a){n.isLoggedIn()||t.path("/login"),e.createNewTimeSheet=function(n,a){var r=new Date(a.getFullYear(),a.getMonth(),a.getDate()+1);r===a&&console.log(r),o.create({title:n,week_beginning:a,week_one:{sunday:{date:Date(a.getFullYear(),a.getMonth(),a.getDate()+5)},monday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+1)},tuesday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+2)},wednesday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+3)},thursday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+4)},friday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+5)},saturday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+6)}},week_two:{sunday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+7)},monday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+8)},tuesday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+9)},wednesday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+10)},thursday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+11)},friday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+12)},saturday:{date:new Date(a.getFullYear(),a.getMonth(),a.getDate()+13)}}}).success(function(n){e.timesheets.unshift(n),t.path("/")})},o.fetch().success(function(t){console.log(t),e.timesheets=t})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc","toastr",function(e,t,n){e.login=function(n,o){e.errorMsg="",t.login(n,o).then(function(t){e.$emit("login",t)},function(t){e.errorMsg="Incorrect H Number/Password."})}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc","toastr",function(e,t,n){e.error=!1,e.errormsg="",e.register=function(o,a,r,s){t.register(o,a,r,s).then(function(t){e.$emit("login",t)},function(t){console.log(t),401==t.status&&(e.error=!0,n.error("This H-Number is already in use, faggot.","Error"))})}}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"DashboardCtrl",templateUrl:"/templates/dashboard.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"/templates/register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"/templates/login.html"}).when("/timesheet/:timesheet_id",{controller:"TimesheetCtrl",templateUrl:"/templates/timesheet.html"})}]),angular.module("app").controller("TimesheetCtrl",["$scope","$routeParams","$location","UserSvc","TimesheetSvc","toastr",function(e,t,n,o,a,r){o.isLoggedIn()||n.path("/login"),a.fetchById(t.timesheet_id).then(function(t){e.timesheet=t.data})}]),angular.module("app").service("TimesheetSvc",["$http",function(e){this.fetch=function(){return e.get("/api/timesheets")},this.fetchById=function(t){return e.get("/api/timesheets/"+t)},this.create=function(t){return e.post("/api/timesheets",t)}}]),angular.module("app").service("UserSvc",["$http",function(e){var t=this;t.getUser=function(){return e.get("/api/users").then(function(e){return e.data})},t.login=function(n,o){return e.post("/api/sessions",{H_number:n,password:o}).then(function(n){return window.sessionStorage.token=n.data,e.defaults.headers.common["x-auth"]=n.data,t.getUser()})},t.register=function(n,o,a,r){return e.post("/api/users",{H_number:n,password:o,name:a,emailaddr:r}).then(function(){return t.login(n,o)},function(e){console.log(e)})},t.isLoggedIn=function(){var t=!1;return window.sessionStorage.token&&(e.defaults.headers.common["x-auth"]=window.sessionStorage.token,t=!0),t}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJkYXNoYm9hcmQuY3RybC5qcyIsImxvZ2luLmN0cmwuanMiLCJyZWdpc3Rlci5jdHJsLmpzIiwicm91dGVzLmpzIiwidGltZXNoZWV0LmN0cmwuanMiLCJ0aW1lc2hlZXQuc3ZjLmpzIiwidXNlci5zdmMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkbG9jYXRpb24iLCIkd2luZG93IiwiVXNlclN2YyIsInRvYXN0ciIsIiRvbiIsIl8iLCJ1c2VyIiwiY3VycmVudFVzZXIiLCJwYXRoIiwibG9nb3V0Iiwid2luZG93Iiwic2Vzc2lvblN0b3JhZ2UiLCJyZW1vdmVJdGVtIiwiaXNMb2dnZWRJbiIsImdldFVzZXIiLCJ0aGVuIiwicmVzcG9uc2UiLCJUaW1lc2hlZXRTdmMiLCJjcmVhdGVOZXdUaW1lU2hlZXQiLCJ0aXRsZSIsIndlZWtfYmVnaW5uaW5nIiwidGVtcERhdGUiLCJEYXRlIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERhdGUiLCJjb25zb2xlIiwibG9nIiwiY3JlYXRlIiwid2Vla19vbmUiLCJzdW5kYXkiLCJkYXRlIiwibW9uZGF5IiwidHVlc2RheSIsIndlZG5lc2RheSIsInRodXJzZGF5IiwiZnJpZGF5Iiwic2F0dXJkYXkiLCJ3ZWVrX3R3byIsInN1Y2Nlc3MiLCJ0aW1lX3NoZWV0IiwidGltZXNoZWV0cyIsInVuc2hpZnQiLCJmZXRjaCIsImxvZ2luIiwiSF9udW1iZXIiLCJwYXNzd29yZCIsImVycm9yTXNnIiwiJGVtaXQiLCJlcnJvciIsImVycm9ybXNnIiwicmVnaXN0ZXIiLCJuYW1lIiwiZW1haWxhZGRyIiwic3RhdHVzIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCIkcm91dGVQYXJhbXMiLCJmZXRjaEJ5SWQiLCJ0aW1lc2hlZXRfaWQiLCJ0aW1lc2hlZXQiLCJkYXRhIiwic2VydmljZSIsIiRodHRwIiwidGhpcyIsImdldCIsImlkIiwicG9zdCIsInN2YyIsInRva2VuIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiY29tbW9uIiwicmVzdWx0Il0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBQUMsT0FBQSxPQUNFLFlDREZELFFBQUFDLE9BQUEsT0FBQSxVQUFBLFdBQ0FDLFdBQUEsbUJBQStCLFNBQUEsWUFBQSxVQUFBLFVBQUEsU0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQVk3QixHQVhBSixFQUFBSyxJQUFBLFFBQUEsU0FBQUMsRUFBQUMsR0FDRVAsRUFBQVEsWUFBQUQsRUFDQU4sRUFBQVEsS0FBQSxPQUdGVCxFQUFBVSxPQUFBLGlCQUNDVixHQUFBLFlBQ0NDLEVBQUFRLEtBQUEsVUFDQUUsT0FBQUMsZUFBQUMsV0FBQSxVQUdGVixFQUFBVyxhQUNFLENBQUFYLEVBQUFZLFVBQUFDLEtBQUEsU0FBQUMsR0FDRWpCLEVBQUFRLFlBQUFTLFFBR0ZoQixHQUFBUSxLQUFBLGFDbEJKWixRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsaUJBQTZCLFNBQUEsWUFBQSxVQUFBLGVBQUEsU0FBQSxTQUFBQyxFQUFBQyxFQUFBRSxFQUFBZSxFQUFBZCxHQUU1QkQsRUFBQVcsY0FDQ2IsRUFBQVEsS0FBQSxVQUdEVCxFQUFBbUIsbUJBQUEsU0FBQUMsRUFBQUMsR0FDQyxHQUFBQyxHQUFBLEdBQUFDLE1BQUFGLEVBQUFHLGNBQUFILEVBQUFJLFdBQUFKLEVBQUFLLFVBQUEsRUFDQUosS0FBQUQsR0FDR00sUUFBQUMsSUFBQU4sR0FDRkosRUFBQVcsUUFDS1QsTUFBQUEsRUFDQUMsZUFBQUEsRUFDQVMsVUFDQ0MsUUFBQUMsS0FBQVQsS0FBQUYsRUFBQUcsY0FBQUgsRUFBQUksV0FBQUosRUFBQUssVUFBQSxJQUNBTyxRQUFBRCxLQUFBLEdBQUFULE1BQUFGLEVBQUFHLGNBQUFILEVBQUFJLFdBQUFKLEVBQUFLLFVBQUEsSUFDQVEsU0FBQUYsS0FBQSxHQUFBVCxNQUFB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b250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXHJcbiAgJ25nUm91dGUnXHJcbl0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ25nUm91dGUnLCd0b2FzdHInXSlcclxuLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRsb2NhdGlvbiwgJHdpbmRvdywgVXNlclN2YywgdG9hc3RyKSB7XHJcbiAgJHNjb3BlLiRvbignbG9naW4nLCBmdW5jdGlvbiAoXywgdXNlcikge1xyXG4gICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlclxyXG4gICAgJGxvY2F0aW9uLnBhdGgoJy8nKVxyXG4gIH0pXHJcblxyXG4gICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpe1xyXG4gIFx0ZGVsZXRlKCRzY29wZS5jdXJyZW50VXNlcikgXHJcbiAgICAkbG9jYXRpb24ucGF0aCgnL2xvZ2luJylcclxuICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCd0b2tlbicpXHJcbiAgfVxyXG5cclxuICBpZihVc2VyU3ZjLmlzTG9nZ2VkSW4oKSl7XHJcblx0ICBcdHZhciB1c2VyID0gVXNlclN2Yy5nZXRVc2VyKCkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XHJcblx0XHQgICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gcmVzcG9uc2U7XHJcblx0ICBcdH0pXHJcbiBcdH1lbHNlIHtcclxuICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKVxyXG4gIH1cclxuXHJcbn0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4uY29udHJvbGxlcignRGFzaGJvYXJkQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRsb2NhdGlvbiwgVXNlclN2YywgVGltZXNoZWV0U3ZjLCB0b2FzdHIpIHtcclxuXHJcblx0aWYoIVVzZXJTdmMuaXNMb2dnZWRJbigpKXtcclxuXHRcdCRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKVxyXG5cdH1cclxuXHJcblx0JHNjb3BlLmNyZWF0ZU5ld1RpbWVTaGVldCA9IGZ1bmN0aW9uKHRpdGxlLCB3ZWVrX2JlZ2lubmluZyl7XHJcblx0XHR2YXIgdGVtcERhdGUgPSBuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAxKVxyXG5cdFx0aWYodGVtcERhdGUgPT09IHdlZWtfYmVnaW5uaW5nKVxyXG5cdCAgXHRcdGNvbnNvbGUubG9nKHRlbXBEYXRlKTtcclxuXHQgIFRpbWVzaGVldFN2Yy5jcmVhdGUoe1xyXG4gICAgICAgIHRpdGxlOiB0aXRsZSxcclxuICAgICAgICB3ZWVrX2JlZ2lubmluZzogd2Vla19iZWdpbm5pbmcsXHJcbiAgICAgICAgd2Vla19vbmU6e1xyXG4gICAgICAgIFx0c3VuZGF5OntkYXRlOkRhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNSkgfSxcclxuXHQgICAgICAgIG1vbmRheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAxKX0sXHJcblx0ICAgICAgICB0dWVzZGF5OntkYXRlOm5ldyBEYXRlKHdlZWtfYmVnaW5uaW5nLmdldEZ1bGxZZWFyKCksIHdlZWtfYmVnaW5uaW5nLmdldE1vbnRoKCksIHdlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDIpfSxcclxuXHQgICAgICAgIHdlZG5lc2RheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAzKX0sXHJcblx0ICAgICAgICB0aHVyc2RheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyA0KX0sXHJcblx0ICAgICAgICBmcmlkYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNSl9LFxyXG4gICAgICAgIFx0c2F0dXJkYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNil9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB3ZWVrX3R3bzp7XHJcbiAgICAgICAgXHRzdW5kYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNyl9LFxyXG5cdCAgICAgICAgbW9uZGF5OntkYXRlOm5ldyBEYXRlKHdlZWtfYmVnaW5uaW5nLmdldEZ1bGxZZWFyKCksIHdlZWtfYmVnaW5uaW5nLmdldE1vbnRoKCksIHdlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDgpfSxcclxuXHQgICAgICAgIHR1ZXNkYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgOSl9LFxyXG5cdCAgICAgICAgd2VkbmVzZGF5OntkYXRlOm5ldyBEYXRlKHdlZWtfYmVnaW5uaW5nLmdldEZ1bGxZZWFyKCksIHdlZWtfYmVnaW5uaW5nLmdldE1vbnRoKCksIHdlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDEwKX0sXHJcblx0ICAgICAgICB0aHVyc2RheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAxMSl9LFxyXG5cdCAgICAgICAgZnJpZGF5OntkYXRlOm5ldyBEYXRlKHdlZWtfYmVnaW5uaW5nLmdldEZ1bGxZZWFyKCksIHdlZWtfYmVnaW5uaW5nLmdldE1vbnRoKCksIHdlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDEyKX0sXHJcbiAgICAgICAgXHRzYXR1cmRheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAxMyl9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgICAuc3VjY2VzcyhmdW5jdGlvbiAodGltZV9zaGVldCkge1xyXG4gICAgICBcdCRzY29wZS50aW1lc2hlZXRzLnVuc2hpZnQodGltZV9zaGVldClcclxuICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xyXG4gICAgICB9KVxyXG5cdH1cclxuXHJcblx0VGltZXNoZWV0U3ZjLmZldGNoKCkuc3VjY2VzcyhmdW5jdGlvbiAodGltZXNoZWV0cykge1xyXG5cdFx0Y29uc29sZS5sb2codGltZXNoZWV0cyk7XHJcblx0XHQkc2NvcGUudGltZXNoZWV0cyA9IHRpbWVzaGVldHM7XHJcblx0fSlcclxuXHRcclxufSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbi5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjLCB0b2FzdHIpIHtcclxuICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAoSF9udW1iZXIsIHBhc3N3b3JkKSB7XHJcbiAgXHQkc2NvcGUuZXJyb3JNc2cgPSAnJztcclxuICAgIFVzZXJTdmMubG9naW4oSF9udW1iZXIsIHBhc3N3b3JkKVxyXG4gICAgLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgJHNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpXHJcbiAgICB9LCBmdW5jdGlvbihlcnJvcil7XHJcbiAgICBcdCRzY29wZS5lcnJvck1zZyA9IFwiSW5jb3JyZWN0IEggTnVtYmVyL1Bhc3N3b3JkLlwiO1xyXG4gICAgfSlcclxuICB9XHJcbn0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4uY29udHJvbGxlcignUmVnaXN0ZXJDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgVXNlclN2YywgdG9hc3RyKSB7XHJcblxyXG5cdCRzY29wZS5lcnJvcj1mYWxzZTtcclxuXHQkc2NvcGUuZXJyb3Jtc2c9XCJcIjtcclxuXHJcbiAgJHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKEhfbnVtYmVyLCBwYXNzd29yZCwgbmFtZSwgZW1haWxhZGRyKSB7XHJcbiAgICBVc2VyU3ZjLnJlZ2lzdGVyKEhfbnVtYmVyLCBwYXNzd29yZCwgbmFtZSwgZW1haWxhZGRyKVxyXG4gICAgLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgJHNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpXHJcbiAgICB9LCBmdW5jdGlvbihlcnJvcil7XHJcbiAgICBcdGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgaWYgKGVycm9yLnN0YXR1cyA9PSA0MDEpe1xyXG4gICAgICBcdCRzY29wZS5lcnJvciA9IHRydWU7XHJcblx0XHR0b2FzdHIuZXJyb3IoJ1RoaXMgSC1OdW1iZXIgaXMgYWxyZWFkeSBpbiB1c2UsIGZhZ2dvdC4nLCAnRXJyb3InKTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcbn0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4uY29uZmlnKGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcikge1xyXG5cdCRyb3V0ZVByb3ZpZGVyXHJcblx0LndoZW4oJy8nLCAgICAgICAgIHsgY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwnLCB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvZGFzaGJvYXJkLmh0bWwnIH0pXHJcblx0LndoZW4oJy9yZWdpc3RlcicsIHsgY29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9yZWdpc3Rlci5odG1sJyB9KVxyXG5cdC53aGVuKCcvbG9naW4nLCAgICB7IGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwnLCB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvbG9naW4uaHRtbCcgfSlcclxuXHQud2hlbignL3RpbWVzaGVldC86dGltZXNoZWV0X2lkJyx7IGNvbnRyb2xsZXI6ICdUaW1lc2hlZXRDdHJsJywgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL3RpbWVzaGVldC5odG1sJyB9KVxyXG59KVxyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbi5jb250cm9sbGVyKCdUaW1lc2hlZXRDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwkcm91dGVQYXJhbXMsICRsb2NhdGlvbiwgVXNlclN2YywgVGltZXNoZWV0U3ZjLCB0b2FzdHIpIHtcclxuXHJcblx0aWYoIVVzZXJTdmMuaXNMb2dnZWRJbigpKXtcclxuXHRcdCRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKVxyXG5cdH1cclxuXHJcblx0VGltZXNoZWV0U3ZjLmZldGNoQnlJZCgkcm91dGVQYXJhbXMudGltZXNoZWV0X2lkKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgJHNjb3BlLnRpbWVzaGVldCA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICB9KVxyXG5cdFxyXG59KVxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuLnNlcnZpY2UoJ1RpbWVzaGVldFN2YycsIGZ1bmN0aW9uICgkaHR0cCkge1xyXG4gIFxyXG4gIHRoaXMuZmV0Y2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3RpbWVzaGVldHMnKVxyXG4gIH1cclxuXHJcbiAgdGhpcy5mZXRjaEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdGltZXNoZWV0cy8nICsgaWQpXHJcbiAgfVxyXG5cclxuICB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uKHRpbWVzaGVldCl7XHJcbiAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS90aW1lc2hlZXRzJywgdGltZXNoZWV0KTtcclxuICB9XHJcbiAgXHJcbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbi5zZXJ2aWNlKCdVc2VyU3ZjJywgZnVuY3Rpb24gKCRodHRwKSB7XHJcbiAgdmFyIHN2YyA9IHRoaXNcclxuICBzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnKVxyXG4gICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhXHJcbiAgICB9KVxyXG4gIH1cclxuICBzdmMubG9naW4gPSBmdW5jdGlvbiAoSF9udW1iZXIsIHBhc3N3b3JkKSB7XHJcbiAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucycsIHtcclxuICAgICAgSF9udW1iZXI6IEhfbnVtYmVyLCBwYXNzd29yZDogcGFzc3dvcmRcclxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS50b2tlbiA9IHJlc3BvbnNlLmRhdGFcclxuICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ3gtYXV0aCddID0gcmVzcG9uc2UuZGF0YVxyXG4gICAgICByZXR1cm4gc3ZjLmdldFVzZXIoKVxyXG4gICAgfSlcclxuICB9XHJcbiAgc3ZjLnJlZ2lzdGVyID0gZnVuY3Rpb24gKEhfbnVtYmVyLCBwYXNzd29yZCwgbmFtZSwgZW1haWxhZGRyKSB7XHJcbiAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS91c2VycycsIHtcclxuICAgICAgSF9udW1iZXI6IEhfbnVtYmVyLCBwYXNzd29yZDogcGFzc3dvcmQsIG5hbWU6IG5hbWUsIGVtYWlsYWRkcjogZW1haWxhZGRyXHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHN2Yy5sb2dpbihIX251bWJlciwgcGFzc3dvcmQpXHJcbiAgICB9LCBmdW5jdGlvbihlcnJvcil7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgIH0pXHJcbiAgfVxyXG4gIHN2Yy5pc0xvZ2dlZEluID0gZnVuY3Rpb24gKCl7XHJcbiAgICB2YXIgcmVzdWx0ID0gZmFsc2U7XHJcbiAgICBpZih3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW4pe1xyXG4gICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsneC1hdXRoJ10gPSB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW5cclxuICAgICAgcmVzdWx0ID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG59KVxyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=