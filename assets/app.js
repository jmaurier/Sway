angular.module("app",["ngRoute"]),angular.module("app").controller("AdminCtrl",["$scope","UserSvc","toastr",function(e,t,n){}]),angular.module("app",["ngRoute","toastr","ui.bootstrap"]).controller("ApplicationCtrl",["$scope","$location","$window","UserSvc","toastr","$modal",function(e,t,n,o,r,a){if(e.$on("login",function(n,o){e.currentUser=o,t.path("/")}),e.logout=function(){delete e.currentUser,t.path("/login"),window.sessionStorage.removeItem("token")},o.isLoggedIn()){o.getUser().then(function(t){e.currentUser=t})}else t.path("/login")}]),angular.module("app").controller("DashboardCtrl",["$scope","$location","UserSvc","TimesheetSvc","toastr",function(e,t,n,o,r){n.isLoggedIn()||t.path("/login"),e.createNewTimeSheet=function(n,r){var a=new Date(r.getFullYear(),r.getMonth(),r.getDate()+1);a===r&&console.log(a),o.create({title:n,week_beginning:r,week_one:{sunday:{date:Date(r.getFullYear(),r.getMonth(),r.getDate()+5)},monday:{date:new Date(r.getFullYear(),r.getMonth(),r.getDate()+1)},tuesday:{date:new Date(r.getFullYear(),r.getMonth(),r.getDate()+2)},wednesday:{date:new Date(r.getFullYear(),r.getMonth(),r.getDate()+3)},thursday:{date:new Date(r.getFullYear(),r.getMonth(),r.getDate()+4)},friday:{date:new Date(r.getFullYear(),r.getMonth(),r.getDate()+5)},saturday:{date:new Date(r.getFullYear(),r.getMonth(),r.getDate()+6)}},week_two:{sunday:{date:new Date(r.getFullYear(),r.getMonth(),r.getDate()+7)},monday:{date:new Date(r.getFullYear(),r.getMonth(),r.getDate()+8)},tuesday:{date:new Date(r.getFullYear(),r.getMonth(),r.getDate()+9)},wednesday:{date:new Date(r.getFullYear(),r.getMonth(),r.getDate()+10)},thursday:{date:new Date(r.getFullYear(),r.getMonth(),r.getDate()+11)},friday:{date:new Date(r.getFullYear(),r.getMonth(),r.getDate()+12)},saturday:{date:new Date(r.getFullYear(),r.getMonth(),r.getDate()+13)}}}).success(function(n){e.timesheets.unshift(n),t.path("/")})},o.fetch().success(function(t){e.timesheets=t})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc","toastr",function(e,t,n){e.login=function(n,o){e.errorMsg="",t.login(n,o).then(function(t){e.$emit("login",t)},function(t){e.errorMsg="Incorrect H Number/Password."})}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc","toastr",function(e,t,n){e.error=!1,e.errormsg="",e.register=function(o,r,a,l){t.register(o,r,a,l).then(function(t){e.$emit("login",t)},function(t){console.log(t),401==t.status&&(e.error=!0,n.error("This H-Number is already in use, faggot.","Error"))})}}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"DashboardCtrl",templateUrl:"/templates/dashboard.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"/templates/register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"/templates/login.html"}).when("/timesheet/:timesheet_id",{controller:"TimesheetCtrl",templateUrl:"/templates/timesheet.html"}).when("/admin",{controller:"AdminCtrl",templateUrl:"/templates/admin.html"})}]),angular.module("app").controller("TimesheetCtrl",["$scope","$routeParams","$location","UserSvc","TimesheetSvc","toastr",function(e,t,n,o,r,a){o.isLoggedIn()||n.path("/login"),e.clockin=function(){},e.clockout=function(){},r.fetchById(t.timesheet_id).then(function(t){e.timesheet=t.data,console.log(e.timesheet)})}]),angular.module("app").service("TimesheetSvc",["$http",function(e){this.fetch=function(){return e.get("/api/timesheets")},this.fetchById=function(t){return e.get("/api/timesheets/"+t)},this.create=function(t){return e.post("/api/timesheets",t)}}]),angular.module("app").service("UserSvc",["$http",function(e){var t=this;t.getUser=function(){return e.get("/api/users").then(function(e){return e.data})},t.login=function(n,o){return e.post("/api/sessions",{H_number:n,password:o}).then(function(n){return window.sessionStorage.token=n.data,e.defaults.headers.common["x-auth"]=n.data,t.getUser()})},t.register=function(n,o,r,a){return e.post("/api/users",{H_number:n,password:o,name:r,emailaddr:a}).then(function(){return t.login(n,o)},function(e){console.log(e)})},t.isLoggedIn=function(){var t=!1;return window.sessionStorage.token&&(e.defaults.headers.common["x-auth"]=window.sessionStorage.token,t=!0),t}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFkbWluLmN0cmwuanMiLCJhcHBsaWNhdGlvbi5jdHJsLmpzIiwiZGFzaGJvYXJkLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicmVnaXN0ZXIuY3RybC5qcyIsInJvdXRlcy5qcyIsInRpbWVzaGVldC5jdHJsLmpzIiwidGltZXNoZWV0LnN2Yy5qcyIsInVzZXIuc3ZjLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiVXNlclN2YyIsInRvYXN0ciIsIiRsb2NhdGlvbiIsIiR3aW5kb3ciLCIkbW9kYWwiLCIkb24iLCJfIiwidXNlciIsImN1cnJlbnRVc2VyIiwicGF0aCIsImxvZ291dCIsIndpbmRvdyIsInNlc3Npb25TdG9yYWdlIiwicmVtb3ZlSXRlbSIsImlzTG9nZ2VkSW4iLCJnZXRVc2VyIiwidGhlbiIsInJlc3BvbnNlIiwiVGltZXNoZWV0U3ZjIiwiY3JlYXRlTmV3VGltZVNoZWV0IiwidGl0bGUiLCJ3ZWVrX2JlZ2lubmluZyIsInRlbXBEYXRlIiwiRGF0ZSIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJnZXREYXRlIiwiY29uc29sZSIsImxvZyIsImNyZWF0ZSIsIndlZWtfb25lIiwic3VuZGF5IiwiZGF0ZSIsIm1vbmRheSIsInR1ZXNkYXkiLCJ3ZWRuZXNkYXkiLCJ0aHVyc2RheSIsImZyaWRheSIsInNhdHVyZGF5Iiwid2Vla190d28iLCJzdWNjZXNzIiwidGltZV9zaGVldCIsInRpbWVzaGVldHMiLCJ1bnNoaWZ0IiwiZmV0Y2giLCJsb2dpbiIsIkhfbnVtYmVyIiwicGFzc3dvcmQiLCJlcnJvck1zZyIsIiRlbWl0IiwiZXJyb3IiLCJlcnJvcm1zZyIsInJlZ2lzdGVyIiwibmFtZSIsImVtYWlsYWRkciIsInN0YXR1cyIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiJHJvdXRlUGFyYW1zIiwiY2xvY2tpbiIsImNsb2Nrb3V0IiwiZmV0Y2hCeUlkIiwidGltZXNoZWV0X2lkIiwidGltZXNoZWV0IiwiZGF0YSIsInNlcnZpY2UiLCIkaHR0cCIsInRoaXMiLCJnZXQiLCJpZCIsInBvc3QiLCJzdmMiLCJ0b2tlbiIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsInJlc3VsdCJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQUFDLE9BQUEsT0FDRSxZQ0RGRCxRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsYUFBeUIsU0FBQSxVQUFBLFNBQUEsU0FBQUMsRUFBQUMsRUFBQUMsT0NEekJMLFFBQUFDLE9BQUEsT0FBQSxVQUFBLFNBQUEsaUJBQ0FDLFdBQUEsbUJBQStCLFNBQUEsWUFBQSxVQUFBLFVBQUEsU0FBQSxTQUFBLFNBQUFDLEVBQUFHLEVBQUFDLEVBQUFILEVBQUFDLEVBQUFHLEdBWTdCLEdBWEFMLEVBQUFNLElBQUEsUUFBQSxTQUFBQyxFQUFBQyxHQUNFUixFQUFBUyxZQUFBRCxFQUNBTCxFQUFBTyxLQUFBLE9BR0ZWLEVBQUFXLE9BQUEsaUJBQ0NYLEdBQUEsWUFDQ0csRUFBQU8sS0FBQSxVQUNBRSxPQUFBQyxlQUFBQyxXQUFBLFVBR0ZiLEVBQUFjLGFBQ0UsQ0FBQWQsRUFBQWUsVUFBQUMsS0FBQSxTQUFBQyxHQUNFbEIsRUFBQVMsWUFBQVMsUUFHRmYsR0FBQU8sS0FBQSxhQ2xCSmIsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLGlCQUE2QixTQUFBLFlBQUEsVUFBQSxlQUFBLFNBQUEsU0FBQUMsRUFBQUcsRUFBQUYsRUFBQWtCLEVBQUFqQixHQUU1QkQsRUFBQWMsY0FDQ1osRUFBQU8sS0FBQSxVQUdEVixFQUFBb0IsbUJBQUEsU0FBQUMsRUFBQUMsR0FDQyxHQUFBQyxHQUFBLEdBQUFDLE1BQUFGLEVBQUFHLGNBQUFILEVBQUFJLFdBQUFKLEVBQUFLLFVBQUEsRUFDQUosS0FBQUQsR0FDR00sUUFBQUMsSUFBQU4sR0FDRkosRUFBQVcsUUFDS1QsTUFBQUEsRUFDQUMsZUFBQUEsRUFDQVMsVUFDQ0MsUUFBQUMsS0FBQVQs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LEtBQUEsV0FDRSxNQUFBeUQsR0FBQTVCLE1BQUFDLEVBQUFDLElBQ0YsU0FBQUcsR0FDRXZCLFFBQUFDLElBQUFzQixNQUdKdUIsRUFBQTNELFdBQUEsV0FDRSxHQUFBZ0UsSUFBQSxDQUtBLE9BSkFuRSxRQUFBQyxlQUFBOEQsUUFDRU4sRUFBQU8sU0FBQUMsUUFBQUMsT0FBQSxVQUFBbEUsT0FBQUMsZUFBQThELE1BQ0FJLEdBQUEsR0FFRkEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcclxuICAnbmdSb3V0ZSdcclxuXSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbi5jb250cm9sbGVyKCdBZG1pbkN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjLCB0b2FzdHIpIHtcclxuIFxyXG59KVxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJywgWyduZ1JvdXRlJywndG9hc3RyJywndWkuYm9vdHN0cmFwJ10pXHJcbi5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sICR3aW5kb3csIFVzZXJTdmMsIHRvYXN0ciwgJG1vZGFsKSB7XHJcbiAgJHNjb3BlLiRvbignbG9naW4nLCBmdW5jdGlvbiAoXywgdXNlcikge1xyXG4gICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlclxyXG4gICAgJGxvY2F0aW9uLnBhdGgoJy8nKVxyXG4gIH0pXHJcblxyXG4gICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpe1xyXG4gIFx0ZGVsZXRlKCRzY29wZS5jdXJyZW50VXNlcikgXHJcbiAgICAkbG9jYXRpb24ucGF0aCgnL2xvZ2luJylcclxuICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCd0b2tlbicpXHJcbiAgfVxyXG5cclxuICBpZihVc2VyU3ZjLmlzTG9nZ2VkSW4oKSl7XHJcblx0ICBcdHZhciB1c2VyID0gVXNlclN2Yy5nZXRVc2VyKCkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XHJcblx0XHQgICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gcmVzcG9uc2U7XHJcblx0ICBcdH0pXHJcbiBcdH1lbHNlIHtcclxuICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKVxyXG4gIH1cclxuXHJcbn0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4uY29udHJvbGxlcignRGFzaGJvYXJkQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRsb2NhdGlvbiwgVXNlclN2YywgVGltZXNoZWV0U3ZjLCB0b2FzdHIpIHtcclxuXHJcblx0aWYoIVVzZXJTdmMuaXNMb2dnZWRJbigpKXtcclxuXHRcdCRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKVxyXG5cdH1cclxuXHJcblx0JHNjb3BlLmNyZWF0ZU5ld1RpbWVTaGVldCA9IGZ1bmN0aW9uKHRpdGxlLCB3ZWVrX2JlZ2lubmluZyl7XHJcblx0XHR2YXIgdGVtcERhdGUgPSBuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAxKVxyXG5cdFx0aWYodGVtcERhdGUgPT09IHdlZWtfYmVnaW5uaW5nKVxyXG5cdCAgXHRcdGNvbnNvbGUubG9nKHRlbXBEYXRlKTtcclxuXHQgIFRpbWVzaGVldFN2Yy5jcmVhdGUoe1xyXG4gICAgICAgIHRpdGxlOiB0aXRsZSxcclxuICAgICAgICB3ZWVrX2JlZ2lubmluZzogd2Vla19iZWdpbm5pbmcsXHJcbiAgICAgICAgd2Vla19vbmU6e1xyXG4gICAgICAgIFx0c3VuZGF5OntkYXRlOkRhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNSkgfSxcclxuXHQgICAgICAgIG1vbmRheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAxKX0sXHJcblx0ICAgICAgICB0dWVzZGF5OntkYXRlOm5ldyBEYXRlKHdlZWtfYmVnaW5uaW5nLmdldEZ1bGxZZWFyKCksIHdlZWtfYmVnaW5uaW5nLmdldE1vbnRoKCksIHdlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDIpfSxcclxuXHQgICAgICAgIHdlZG5lc2RheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAzKX0sXHJcblx0ICAgICAgICB0aHVyc2RheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyA0KX0sXHJcblx0ICAgICAgICBmcmlkYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNSl9LFxyXG4gICAgICAgIFx0c2F0dXJkYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNil9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB3ZWVrX3R3bzp7XHJcbiAgICAgICAgXHRzdW5kYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNyl9LFxyXG5cdCAgICAgICAgbW9uZGF5OntkYXRlOm5ldyBEYXRlKHdlZWtfYmVnaW5uaW5nLmdldEZ1bGxZZWFyKCksIHdlZWtfYmVnaW5uaW5nLmdldE1vbnRoKCksIHdlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDgpfSxcclxuXHQgICAgICAgIHR1ZXNkYXk6e2RhdGU6bmV3IERhdGUod2Vla19iZWdpbm5pbmcuZ2V0RnVsbFllYXIoKSwgd2Vla19iZWdpbm5pbmcuZ2V0TW9udGgoKSwgd2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgOSl9LFxyXG5cdCAgICAgICAgd2VkbmVzZGF5OntkYXRlOm5ldyBEYXRlKHdlZWtfYmVnaW5uaW5nLmdldEZ1bGxZZWFyKCksIHdlZWtfYmVnaW5uaW5nLmdldE1vbnRoKCksIHdlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDEwKX0sXHJcblx0ICAgICAgICB0aHVyc2RheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAxMSl9LFxyXG5cdCAgICAgICAgZnJpZGF5OntkYXRlOm5ldyBEYXRlKHdlZWtfYmVnaW5uaW5nLmdldEZ1bGxZZWFyKCksIHdlZWtfYmVnaW5uaW5nLmdldE1vbnRoKCksIHdlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDEyKX0sXHJcbiAgICAgICAgXHRzYXR1cmRheTp7ZGF0ZTpuZXcgRGF0ZSh3ZWVrX2JlZ2lubmluZy5nZXRGdWxsWWVhcigpLCB3ZWVrX2JlZ2lubmluZy5nZXRNb250aCgpLCB3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAxMyl9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgICAuc3VjY2VzcyhmdW5jdGlvbiAodGltZV9zaGVldCkge1xyXG4gICAgICBcdCRzY29wZS50aW1lc2hlZXRzLnVuc2hpZnQodGltZV9zaGVldClcclxuICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xyXG4gICAgICB9KVxyXG5cdH1cclxuXHJcblx0VGltZXNoZWV0U3ZjLmZldGNoKCkuc3VjY2VzcyhmdW5jdGlvbiAodGltZXNoZWV0cykge1xyXG5cdFx0JHNjb3BlLnRpbWVzaGVldHMgPSB0aW1lc2hlZXRzO1xyXG5cdH0pXHJcblx0XHJcbn0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4uY29udHJvbGxlcignTG9naW5DdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgVXNlclN2YywgdG9hc3RyKSB7XHJcbiAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKEhfbnVtYmVyLCBwYXNzd29yZCkge1xyXG4gIFx0JHNjb3BlLmVycm9yTXNnID0gJyc7XHJcbiAgICBVc2VyU3ZjLmxvZ2luKEhfbnVtYmVyLCBwYXNzd29yZClcclxuICAgIC50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICRzY29wZS4kZW1pdCgnbG9naW4nLCB1c2VyKVxyXG4gICAgfSwgZnVuY3Rpb24oZXJyb3Ipe1xyXG4gICAgXHQkc2NvcGUuZXJyb3JNc2cgPSBcIkluY29ycmVjdCBIIE51bWJlci9QYXNzd29yZC5cIjtcclxuICAgIH0pXHJcbiAgfVxyXG59KVxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMsIHRvYXN0cikge1xyXG5cclxuXHQkc2NvcGUuZXJyb3I9ZmFsc2U7XHJcblx0JHNjb3BlLmVycm9ybXNnPVwiXCI7XHJcblxyXG5cdCRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uIChIX251bWJlciwgcGFzc3dvcmQsIG5hbWUsIGVtYWlsYWRkcikge1xyXG5cdFx0VXNlclN2Yy5yZWdpc3RlcihIX251bWJlciwgcGFzc3dvcmQsIG5hbWUsIGVtYWlsYWRkcilcclxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcclxuXHRcdFx0ICAkc2NvcGUuJGVtaXQoJ2xvZ2luJywgdXNlcilcclxuXHRcdFx0fSwgZnVuY3Rpb24oZXJyb3Ipe1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKGVycm9yKTtcclxuXHRcdFx0ICBpZiAoZXJyb3Iuc3RhdHVzID09IDQwMSl7XHJcblx0XHRcdCAgXHQkc2NvcGUuZXJyb3IgPSB0cnVlO1xyXG5cdFx0XHRcdHRvYXN0ci5lcnJvcignVGhpcyBILU51bWJlciBpcyBhbHJlYWR5IGluIHVzZSwgZmFnZ290LicsICdFcnJvcicpO1xyXG5cdFx0XHQgIH1cclxuXHRcdFx0fSlcclxuXHR9XHJcbn0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4uY29uZmlnKGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcikge1xyXG5cdCRyb3V0ZVByb3ZpZGVyXHJcblx0LndoZW4oJy8nLCAgICAgICAgIHsgY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwnLCB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvZGFzaGJvYXJkLmh0bWwnIH0pXHJcblx0LndoZW4oJy9yZWdpc3RlcicsIHsgY29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9yZWdpc3Rlci5odG1sJyB9KVxyXG5cdC53aGVuKCcvbG9naW4nLCAgICB7IGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwnLCB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvbG9naW4uaHRtbCcgfSlcclxuXHQud2hlbignL3RpbWVzaGVldC86dGltZXNoZWV0X2lkJyx7IGNvbnRyb2xsZXI6ICdUaW1lc2hlZXRDdHJsJywgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL3RpbWVzaGVldC5odG1sJyB9KVxyXG5cdC53aGVuKCcvYWRtaW4nLHsgY29udHJvbGxlcjogJ0FkbWluQ3RybCcsIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9hZG1pbi5odG1sJyAgfSlcclxufSlcclxuXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4uY29udHJvbGxlcignVGltZXNoZWV0Q3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsJHJvdXRlUGFyYW1zLCAkbG9jYXRpb24sIFVzZXJTdmMsIFRpbWVzaGVldFN2YywgdG9hc3RyKSB7XHJcblxyXG5cdGlmKCFVc2VyU3ZjLmlzTG9nZ2VkSW4oKSl7XHJcblx0XHQkbG9jYXRpb24ucGF0aCgnL2xvZ2luJylcclxuXHR9XHJcblxyXG5cdCRzY29wZS5jbG9ja2luID0gZnVuY3Rpb24oKXtcclxuXHRcdFxyXG5cdH1cclxuXHJcblx0JHNjb3BlLmNsb2Nrb3V0ID0gZnVuY3Rpb24oKXtcclxuXHRcdFxyXG5cdH1cclxuXHJcblx0VGltZXNoZWV0U3ZjLmZldGNoQnlJZCgkcm91dGVQYXJhbXMudGltZXNoZWV0X2lkKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuICAgICAgJHNjb3BlLnRpbWVzaGVldCA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgIGNvbnNvbGUubG9nKCRzY29wZS50aW1lc2hlZXQpO1xyXG4gICAgfSlcclxuXHRcclxufSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbi5zZXJ2aWNlKCdUaW1lc2hlZXRTdmMnLCBmdW5jdGlvbiAoJGh0dHApIHtcclxuICBcclxuICB0aGlzLmZldGNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS90aW1lc2hlZXRzJylcclxuICB9XHJcblxyXG4gIHRoaXMuZmV0Y2hCeUlkID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3RpbWVzaGVldHMvJyArIGlkKVxyXG4gIH1cclxuXHJcbiAgdGhpcy5jcmVhdGUgPSBmdW5jdGlvbih0aW1lc2hlZXQpe1xyXG4gICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvdGltZXNoZWV0cycsIHRpbWVzaGVldCk7XHJcbiAgfVxyXG4gIFxyXG59KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4uc2VydmljZSgnVXNlclN2YycsIGZ1bmN0aW9uICgkaHR0cCkge1xyXG4gIHZhciBzdmMgPSB0aGlzXHJcbiAgc3ZjLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJylcclxuICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YVxyXG4gICAgfSlcclxuICB9XHJcbiAgc3ZjLmxvZ2luID0gZnVuY3Rpb24gKEhfbnVtYmVyLCBwYXNzd29yZCkge1xyXG4gICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMnLCB7XHJcbiAgICAgIEhfbnVtYmVyOiBIX251bWJlciwgcGFzc3dvcmQ6IHBhc3N3b3JkXHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW4gPSByZXNwb25zZS5kYXRhXHJcbiAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyd4LWF1dGgnXSA9IHJlc3BvbnNlLmRhdGFcclxuICAgICAgcmV0dXJuIHN2Yy5nZXRVc2VyKClcclxuICAgIH0pXHJcbiAgfVxyXG4gIHN2Yy5yZWdpc3RlciA9IGZ1bmN0aW9uIChIX251bWJlciwgcGFzc3dvcmQsIG5hbWUsIGVtYWlsYWRkcikge1xyXG4gICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XHJcbiAgICAgIEhfbnVtYmVyOiBIX251bWJlciwgcGFzc3dvcmQ6IHBhc3N3b3JkLCBuYW1lOiBuYW1lLCBlbWFpbGFkZHI6IGVtYWlsYWRkclxyXG4gICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBzdmMubG9naW4oSF9udW1iZXIsIHBhc3N3b3JkKVxyXG4gICAgfSwgZnVuY3Rpb24oZXJyb3Ipe1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICB9KVxyXG4gIH1cclxuICBzdmMuaXNMb2dnZWRJbiA9IGZ1bmN0aW9uICgpe1xyXG4gICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xyXG4gICAgaWYod2luZG93LnNlc3Npb25TdG9yYWdlLnRva2VuKXtcclxuICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ3gtYXV0aCddID0gd2luZG93LnNlc3Npb25TdG9yYWdlLnRva2VuXHJcbiAgICAgIHJlc3VsdCA9IHRydWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxufSlcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
