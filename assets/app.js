angular.module("app",["ngRoute"]),angular.module("app",["ngRoute","toastr"]).controller("ApplicationCtrl",["$scope","$location","$window","UserSvc","toastr",function(e,t,n,o,r){if(e.$on("login",function(n,o){e.currentUser=o,t.path("/")}),e.logout=function(){delete e.currentUser,t.path("/login"),window.sessionStorage.removeItem("token")},o.isLoggedIn()){o.getUser().then(function(t){e.currentUser=t})}else t.path("/login")}]),angular.module("app").controller("DashboardCtrl",["$scope","$location","UserSvc","TimesheetSvc","toastr",function(e,t,n,o,r){n.isLoggedIn()||t.path("/login"),e.createNewTimeSheet=function(n,r){var a=new Date(r.getFullYear(),r.getMonth(),r.getDate()+1);console.log(a),o.create({title:n,week_beginning:r,week_one:{sunday:{date:r},monday:{date:r.getDate()+1},tuesday:{date:r.getDate()+2},wednesday:{date:r.getDate()+3},thursday:{date:r.getDate()+4},friday:{date:r.getDate()+5},saturday:{date:r.getDate()+6}},week_two:{sunday:{date:r.getDate()+7},monday:{date:r.getDate()+8},tuesday:{date:r.getDate()+9},wednesday:{date:r.getDate()+10},thursday:{date:r.getDate()+11},friday:{date:r.getDate()+12},saturday:{date:r.getDate()+13}}}).success(function(n){e.timesheets.unshift(n),t.path("/")})},o.fetch().success(function(t){console.log(t),e.timesheets=t})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc","toastr",function(e,t,n){e.login=function(n,o){e.errorMsg="",t.login(n,o).then(function(t){e.$emit("login",t)},function(t){e.errorMsg="Incorrect H Number/Password."})}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(e,t){e.register=function(n,o,r){t.register(n,o,r).then(function(t){e.$emit("login",t)})}}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"DashboardCtrl",templateUrl:"/templates/dashboard.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"/templates/register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"/templates/login.html"}).when("/timesheet/:timesheet_id",{controller:"TimesheetCtrl",templateUrl:"/templates/timesheet.html"})}]),angular.module("app").controller("TimesheetCtrl",["$scope","$routeParams","$location","UserSvc","TimesheetSvc","toastr",function(e,t,n,o,r,a){o.isLoggedIn()||n.path("/login"),r.fetchById(t.timesheet_id).then(function(t){e.timesheet=t.data})}]),angular.module("app").service("TimesheetSvc",["$http",function(e){this.fetch=function(){return e.get("/api/timesheets")},this.fetchById=function(t){return e.get("/api/timesheets/"+t)},this.create=function(t){return e.post("/api/timesheets",t)}}]),angular.module("app").service("UserSvc",["$http",function(e){var t=this;t.getUser=function(){return e.get("/api/users").then(function(e){return e.data})},t.login=function(n,o){return e.post("/api/sessions",{H_number:n,password:o}).then(function(n){return window.sessionStorage.token=n.data,e.defaults.headers.common["x-auth"]=n.data,t.getUser()})},t.register=function(n,o,r){return e.post("/api/users",{H_number:n,password:o,name:r}).then(function(){return t.login(n,o,r)})},t.isLoggedIn=function(){var t=!1;return window.sessionStorage.token&&(e.defaults.headers.common["x-auth"]=window.sessionStorage.token,t=!0),t}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJkYXNoYm9hcmQuY3RybC5qcyIsImxvZ2luLmN0cmwuanMiLCJyZWdpc3Rlci5jdHJsLmpzIiwicm91dGVzLmpzIiwidGltZXNoZWV0LmN0cmwuanMiLCJ0aW1lc2hlZXQuc3ZjLmpzIiwidXNlci5zdmMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkbG9jYXRpb24iLCIkd2luZG93IiwiVXNlclN2YyIsInRvYXN0ciIsIiRvbiIsIl8iLCJ1c2VyIiwiY3VycmVudFVzZXIiLCJwYXRoIiwibG9nb3V0Iiwid2luZG93Iiwic2Vzc2lvblN0b3JhZ2UiLCJyZW1vdmVJdGVtIiwiaXNMb2dnZWRJbiIsImdldFVzZXIiLCJ0aGVuIiwicmVzcG9uc2UiLCJUaW1lc2hlZXRTdmMiLCJjcmVhdGVOZXdUaW1lU2hlZXQiLCJ0aXRsZSIsIndlZWtfYmVnaW5uaW5nIiwidGVtcERhdGUiLCJEYXRlIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERhdGUiLCJjb25zb2xlIiwibG9nIiwiY3JlYXRlIiwid2Vla19vbmUiLCJzdW5kYXkiLCJkYXRlIiwibW9uZGF5IiwidHVlc2RheSIsIndlZG5lc2RheSIsInRodXJzZGF5IiwiZnJpZGF5Iiwic2F0dXJkYXkiLCJ3ZWVrX3R3byIsInN1Y2Nlc3MiLCJ0aW1lX3NoZWV0IiwidGltZXNoZWV0cyIsInVuc2hpZnQiLCJmZXRjaCIsImxvZ2luIiwiSF9udW1iZXIiLCJwYXNzd29yZCIsImVycm9yTXNnIiwiJGVtaXQiLCJlcnJvciIsInJlZ2lzdGVyIiwibmFtZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiJHJvdXRlUGFyYW1zIiwiZmV0Y2hCeUlkIiwidGltZXNoZWV0X2lkIiwidGltZXNoZWV0IiwiZGF0YSIsInNlcnZpY2UiLCIkaHR0cCIsInRoaXMiLCJnZXQiLCJpZCIsInBvc3QiLCJzdmMiLCJ0b2tlbiIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsInJlc3VsdCJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQUFDLE9BQUEsT0FDRSxZQ0RGRCxRQUFBQyxPQUFBLE9BQUEsVUFBQSxXQUNBQyxXQUFBLG1CQUErQixTQUFBLFlBQUEsVUFBQSxVQUFBLFNBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FZN0IsR0FYQUosRUFBQUssSUFBQSxRQUFBLFNBQUFDLEVBQUFDLEdBQ0VQLEVBQUFRLFlBQUFELEVBQ0FOLEVBQUFRLEtBQUEsT0FHRlQsRUFBQVUsT0FBQSxpQkFDQ1YsR0FBQSxZQUNDQyxFQUFBUSxLQUFBLFVBQ0FFLE9BQUFDLGVBQUFDLFdBQUEsVUFHRlYsRUFBQVcsYUFDRSxDQUFBWCxFQUFBWSxVQUFBQyxLQUFBLFNBQUFDLEdBQ0VqQixFQUFBUSxZQUFBUyxRQUdGaEIsR0FBQVEsS0FBQSxhQ2xCSlosUUFBQUMsT0FBQSxPQUNBQyxXQUFBLGlCQUE2QixTQUFBLFlBQUEsVUFBQSxlQUFBLFNBQUEsU0FBQUMsRUFBQUMsRUFBQUUsRUFBQWUsRUFBQWQsR0FFNUJELEVBQUFXLGNBQ0NiLEVBQUFRLEtBQUEsVUFHRFQsRUFBQW1CLG1CQUFBLFNBQUFDLEVBQUFDLEdBQ0MsR0FBQUMsR0FBQSxHQUFBQyxNQUFBRixFQUFBRyxjQUFBSCxFQUFBSSxXQUFBSixFQUFBSyxVQUFBLEVBQ0VDLFNBQUFDLElBQUFOLEdBQ0RKLEVBQUFXLFFBQ0tULE1BQUFBLEVBQ0FDLGVBQUFBLEVBQ0FTLFVBQ0NDLFFBQUFDLEtBQUFYLEdBQ0FZLFFBQUFELEtBQUFYLEVBQUFLLFVBQUEsR0FDQVEsU0FBQUYsS0FBQVgsRUFBQUssVUFBQSxHQUNBUyxXQUFBSCxLQUFBWCxFQUFBSyxVQUFBLEdBQ0FVLFVBQUFKLEtBQUFYLEVBQUFLLFVBQUEsR0FDQVcsUUFBQUwsS0FBQVgsRUFBQUssVUFBQSxHQUNBWSxVQUFBTixLQUFBWCxFQUFBSyxVQUFBLElB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QyxFQUFBSyxNQUdKZ0IsRUFBQXRELFdBQUEsV0FDRSxHQUFBMkQsSUFBQSxDQUtBLE9BSkE5RCxRQUFBQyxlQUFBeUQsUUFDRU4sRUFBQU8sU0FBQUMsUUFBQUMsT0FBQSxVQUFBN0QsT0FBQUMsZUFBQXlELE1BQ0FJLEdBQUEsR0FFRkEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcclxuICAnbmdSb3V0ZSdcclxuXSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnbmdSb3V0ZScsJ3RvYXN0ciddKVxyXG4uY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCAkd2luZG93LCBVc2VyU3ZjLCB0b2FzdHIpIHtcclxuICAkc2NvcGUuJG9uKCdsb2dpbicsIGZ1bmN0aW9uIChfLCB1c2VyKSB7XHJcbiAgICAkc2NvcGUuY3VycmVudFVzZXIgPSB1c2VyXHJcbiAgICAkbG9jYXRpb24ucGF0aCgnLycpXHJcbiAgfSlcclxuXHJcbiAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCl7XHJcbiAgXHRkZWxldGUoJHNjb3BlLmN1cnJlbnRVc2VyKSBcclxuICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKVxyXG4gICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oJ3Rva2VuJylcclxuICB9XHJcblxyXG4gIGlmKFVzZXJTdmMuaXNMb2dnZWRJbigpKXtcclxuXHQgIFx0dmFyIHVzZXIgPSBVc2VyU3ZjLmdldFVzZXIoKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuXHRcdCAgICAkc2NvcGUuY3VycmVudFVzZXIgPSByZXNwb25zZTtcclxuXHQgIFx0fSlcclxuIFx0fWVsc2Uge1xyXG4gICAgJGxvY2F0aW9uLnBhdGgoJy9sb2dpbicpXHJcbiAgfVxyXG5cclxufSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbi5jb250cm9sbGVyKCdEYXNoYm9hcmRDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCBVc2VyU3ZjLCBUaW1lc2hlZXRTdmMsIHRvYXN0cikge1xyXG5cclxuXHRpZighVXNlclN2Yy5pc0xvZ2dlZEluKCkpe1xyXG5cdFx0JGxvY2F0aW9uLnBhdGgoJy9sb2dpbicpXHJcblx0fVxyXG5cclxuXHQkc2NvcGUuY3JlYXRlTmV3VGltZVNoZWV0ID0gZnVuY3Rpb24odGl0bGUsIHdlZWtfYmVnaW5uaW5nKXtcclxuXHRcdHZhciB0ZW1wRGF0ZSA9IG5ldyBEYXRlKHdlZWtfYmVnaW5uaW5nLmdldEZ1bGxZZWFyKCksIHdlZWtfYmVnaW5uaW5nLmdldE1vbnRoKCksIHdlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDEpXHJcblx0ICBcdGNvbnNvbGUubG9nKHRlbXBEYXRlKTtcclxuXHQgIFRpbWVzaGVldFN2Yy5jcmVhdGUoe1xyXG4gICAgICAgIHRpdGxlOiB0aXRsZSxcclxuICAgICAgICB3ZWVrX2JlZ2lubmluZzogd2Vla19iZWdpbm5pbmcsXHJcbiAgICAgICAgd2Vla19vbmU6e1xyXG4gICAgICAgIFx0c3VuZGF5OntkYXRlOndlZWtfYmVnaW5uaW5nIH0sXHJcblx0ICAgICAgICBtb25kYXk6e2RhdGU6d2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgMX0sXHJcblx0ICAgICAgICB0dWVzZGF5OntkYXRlOndlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDJ9LFxyXG5cdCAgICAgICAgd2VkbmVzZGF5OntkYXRlOndlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDN9LFxyXG5cdCAgICAgICAgdGh1cnNkYXk6e2RhdGU6d2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNH0sXHJcblx0ICAgICAgICBmcmlkYXk6e2RhdGU6d2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgNX0sXHJcbiAgICAgICAgXHRzYXR1cmRheTp7ZGF0ZTp3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyA2fVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgd2Vla190d286e1xyXG4gICAgICAgIFx0c3VuZGF5OntkYXRlOndlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDd9LFxyXG5cdCAgICAgICAgbW9uZGF5OntkYXRlOndlZWtfYmVnaW5uaW5nLmdldERhdGUoKSArIDh9LFxyXG5cdCAgICAgICAgdHVlc2RheTp7ZGF0ZTp3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyA5fSxcclxuXHQgICAgICAgIHdlZG5lc2RheTp7ZGF0ZTp3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAxMH0sXHJcblx0ICAgICAgICB0aHVyc2RheTp7ZGF0ZTp3ZWVrX2JlZ2lubmluZy5nZXREYXRlKCkgKyAxMX0sXHJcblx0ICAgICAgICBmcmlkYXk6e2RhdGU6d2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgMTJ9LFxyXG4gICAgICAgIFx0c2F0dXJkYXk6e2RhdGU6d2Vla19iZWdpbm5pbmcuZ2V0RGF0ZSgpICsgMTN9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgICAuc3VjY2VzcyhmdW5jdGlvbiAodGltZV9zaGVldCkge1xyXG4gICAgICBcdCRzY29wZS50aW1lc2hlZXRzLnVuc2hpZnQodGltZV9zaGVldClcclxuICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xyXG4gICAgICB9KVxyXG5cdH1cclxuXHJcblx0VGltZXNoZWV0U3ZjLmZldGNoKCkuc3VjY2VzcyhmdW5jdGlvbiAodGltZXNoZWV0cykge1xyXG5cdFx0Y29uc29sZS5sb2codGltZXNoZWV0cyk7XHJcblx0XHQkc2NvcGUudGltZXNoZWV0cyA9IHRpbWVzaGVldHM7XHJcblx0fSlcclxuXHRcclxufSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbi5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjLCB0b2FzdHIpIHtcclxuICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAoSF9udW1iZXIsIHBhc3N3b3JkKSB7XHJcbiAgXHQkc2NvcGUuZXJyb3JNc2cgPSAnJztcclxuICAgIFVzZXJTdmMubG9naW4oSF9udW1iZXIsIHBhc3N3b3JkKVxyXG4gICAgLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgJHNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpXHJcbiAgICB9LCBmdW5jdGlvbihlcnJvcil7XHJcbiAgICBcdCRzY29wZS5lcnJvck1zZyA9IFwiSW5jb3JyZWN0IEggTnVtYmVyL1Bhc3N3b3JkLlwiO1xyXG4gICAgfSlcclxuICB9XHJcbn0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4uY29udHJvbGxlcignUmVnaXN0ZXJDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgVXNlclN2Yykge1xyXG4gICRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uIChIX251bWJlciwgcGFzc3dvcmQsIG5hbWUpIHtcclxuICAgIFVzZXJTdmMucmVnaXN0ZXIoSF9udW1iZXIsIHBhc3N3b3JkLCBuYW1lKVxyXG4gICAgLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgJHNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpXHJcbiAgICB9KVxyXG4gIH1cclxufSlcclxuXHJcblxyXG4gIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbi5jb25maWcoZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKSB7XHJcblx0JHJvdXRlUHJvdmlkZXJcclxuXHQud2hlbignLycsICAgICAgICAgeyBjb250cm9sbGVyOiAnRGFzaGJvYXJkQ3RybCcsIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9kYXNoYm9hcmQuaHRtbCcgfSlcclxuXHQud2hlbignL3JlZ2lzdGVyJywgeyBjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJywgdGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL3JlZ2lzdGVyLmh0bWwnIH0pXHJcblx0LndoZW4oJy9sb2dpbicsICAgIHsgY29udHJvbGxlcjogJ0xvZ2luQ3RybCcsIHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9sb2dpbi5odG1sJyB9KVxyXG5cdC53aGVuKCcvdGltZXNoZWV0Lzp0aW1lc2hlZXRfaWQnLHsgY29udHJvbGxlcjogJ1RpbWVzaGVldEN0cmwnLCB0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvdGltZXNoZWV0Lmh0bWwnIH0pXHJcbn0pXHJcblxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuLmNvbnRyb2xsZXIoJ1RpbWVzaGVldEN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCRyb3V0ZVBhcmFtcywgJGxvY2F0aW9uLCBVc2VyU3ZjLCBUaW1lc2hlZXRTdmMsIHRvYXN0cikge1xyXG5cclxuXHRpZighVXNlclN2Yy5pc0xvZ2dlZEluKCkpe1xyXG5cdFx0JGxvY2F0aW9uLnBhdGgoJy9sb2dpbicpXHJcblx0fVxyXG5cclxuXHRUaW1lc2hlZXRTdmMuZmV0Y2hCeUlkKCRyb3V0ZVBhcmFtcy50aW1lc2hlZXRfaWQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xyXG4gICAgICAkc2NvcGUudGltZXNoZWV0ID0gcmVzcG9uc2UuZGF0YTtcclxuICAgIH0pXHJcblx0XHJcbn0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4uc2VydmljZSgnVGltZXNoZWV0U3ZjJywgZnVuY3Rpb24gKCRodHRwKSB7XHJcbiAgXHJcbiAgdGhpcy5mZXRjaCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdGltZXNoZWV0cycpXHJcbiAgfVxyXG5cclxuICB0aGlzLmZldGNoQnlJZCA9IGZ1bmN0aW9uIChpZCkge1xyXG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS90aW1lc2hlZXRzLycgKyBpZClcclxuICB9XHJcblxyXG4gIHRoaXMuY3JlYXRlID0gZnVuY3Rpb24odGltZXNoZWV0KXtcclxuICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3RpbWVzaGVldHMnLCB0aW1lc2hlZXQpO1xyXG4gIH1cclxuICBcclxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuLnNlcnZpY2UoJ1VzZXJTdmMnLCBmdW5jdGlvbiAoJGh0dHApIHtcclxuICB2YXIgc3ZjID0gdGhpc1xyXG4gIHN2Yy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpXHJcbiAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGFcclxuICAgIH0pXHJcbiAgfVxyXG4gIHN2Yy5sb2dpbiA9IGZ1bmN0aW9uIChIX251bWJlciwgcGFzc3dvcmQpIHtcclxuICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywge1xyXG4gICAgICBIX251bWJlcjogSF9udW1iZXIsIHBhc3N3b3JkOiBwYXNzd29yZFxyXG4gICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnRva2VuID0gcmVzcG9uc2UuZGF0YVxyXG4gICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsneC1hdXRoJ10gPSByZXNwb25zZS5kYXRhXHJcbiAgICAgIHJldHVybiBzdmMuZ2V0VXNlcigpXHJcbiAgICB9KVxyXG4gIH1cclxuICBzdmMucmVnaXN0ZXIgPSBmdW5jdGlvbiAoSF9udW1iZXIsIHBhc3N3b3JkLCBuYW1lKSB7XHJcbiAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS91c2VycycsIHtcclxuICAgICAgSF9udW1iZXI6IEhfbnVtYmVyLCBwYXNzd29yZDogcGFzc3dvcmQsIG5hbWU6IG5hbWVcclxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gc3ZjLmxvZ2luKEhfbnVtYmVyLCBwYXNzd29yZCwgbmFtZSlcclxuICAgIH0pXHJcbiAgfVxyXG4gIHN2Yy5pc0xvZ2dlZEluID0gZnVuY3Rpb24gKCl7XHJcbiAgICB2YXIgcmVzdWx0ID0gZmFsc2U7XHJcbiAgICBpZih3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW4pe1xyXG4gICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsneC1hdXRoJ10gPSB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudG9rZW5cclxuICAgICAgcmVzdWx0ID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG59KVxyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=